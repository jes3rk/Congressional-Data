<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>CongressWatch</title>
  <!-- <link rel="stylesheet" href="./css/reset.css"> -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/custom.css">
  <link rel="stylesheet" media="screen" href="https://fontlibrary.org/face/cmu-serif" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Spectral+SC" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Great+Vibes" rel="stylesheet">
  <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha256-k2WSCIexGzOj3Euiig+TlR8gA0EmPjuc79OEeY5L45g=" crossorigin="anonymous"></script> -->
  <!--[if IE]>
		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
  <script
    src="https://code.jquery.com/jquery-3.2.1.min.js"
    integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
  <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
  <script src="./voting_pct_data.js" charset="utf-8"></script>

  <!-- D3 -->
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>

  <script "text/javascript">
    function show() {
      document.getElementById("congressdrop").style.display = "block";
    }

    function show2() {
      document.getElementById("congressdrop2").style.display = "block";
    }

    function show3() {
      document.getElementById("congressdrop3").style.display = "block";
    }
  </script>
<!-- style="background-image:url(./images/houseinterior.jpg)" -->
<body id="results" >
  <div class="row">
    <div class="col-md-3"></div>
    <div class="col-md-6 center">
      <div class="title">
        <img src="./images/usflag1.png" alt="american flag" class="flagPin">
        <h2>CongressWatch</h2>
        <!-- <h2>C</h2><img src="./images/seal.png" id="seal"><h2>ngress</h2><h2>Watch</h2> -->
        <img src="./images/usflag2.png" alt="american flag" class="flagPin">
      </div>
    </div>
    <div class="col-md-3"></div>
  </div>
  <div class="thing">
    <!-- open main row -->
    <div class="row">
      <!-- open side bar col -->
      <div class="col-md-3">
        <!-- open image row -->
        <div id="pic-row" class="row top">

        </div>
        <div id="contact" class="row">

        </div>
        <div class="basic-info">

        </div>
        <div class="tool">

        </div>

      </div>
    </br>
  </br>
      <!-- open main col -->
      <div class="col-md-9">
        <!-- open name row -->
        <div id="name-row" class="row top">

        </div>
        <!-- open body row -->
        <div class="row main">
          <!-- open body col -->
          <div class="col-md-12">
            <!-- open btn row -->
            <div class="row">
              <div class="col-md-6">
                <button id="pVoteBtn" type="button" class="btn btn-primary btn-lg btn-block">Party Vote</button>
              </div>
              <div class="col-md-6">
                <button id="mVoteBtn" type="button" class="btn btn-primary btn-lg btn-block">Missed Vote</button>
              </div>
            </div>

            <!-- open donut row -->
            <div class="row doRow">
              <h3 id="doID"></h3>
              <!-- open first col -->
              <div id="memDo" class="col-md-4 donut">

              </div>
              <!-- open second col -->
              <div id="partyDo" class="col-md-4 donut">

              </div>
              <!-- open third col -->
              <div id="chamDo" class="col-md-4 donut">

              </div>
            </div>
            <!-- open hist row -->
            <div class="row">
              <h3 id="histID"></h3>
              <div class="chart">

              </div>
            </div>
          </div>
        </div>
        <!-- Citation Row -->
        <div class="row">
          <h3>All data is sourced from the <a href="https://www.propublica.org/datastore/api/propublica-congress-api" target="_blank">ProPublica Congress API</a></h3>
        </div>
      </div>
    </div>
  </div>








  <!-- <section id="datapull">


    <ul style="list-style:none;">
      <li>
        <h2 id="congressname">Mitch Mconnell</h2></li>
      <li>
        <div id="congressphoto"><img src="https://theunitedstates.io/images/congress/225x275/M000355.jpg" alt="Mitch McConnell" style="width:100px;height:125px;"></div>
      </li>
      <li>
        <p id="congresshouse">Senate</p>
      </li>
      <li>
        <p id="congressrank">Majority Leader</p>
      </li>
      <li>
        <p id="congressstate">Kentucky</p>
      </li>
      <li>
        <p id="congressdob">02/20/1942</p>
      </li>
      <li>
        <a onclick="show();">History</a>
        <div id="congressdrop" style="display: none">
          <section id="history"> Senior Senator from Kentucky. President pro-Tem of the Senate</section</div>
      </li>

      <li>
        <a onclick="show2();">Present/Absent</a>
        <div id="congressdrop2" style="display: none">
          <section id="Voting"> Votes and doesn't vote.</section</div>
      </li>
      <li>
        <a onclick="show3();">Aye/Nay/Abstain</a>
        <div id="congressdrop3" style="display: none">
          <section id="AyeNay"> Aye sometimes, nay othertimes</section</div>
      </li>

      <div id="partyLoyalty"></div>

    </ul> -->

    </section>
<script type="text/javascript">


  $(document).ready(function() {

    var memID;
    var detailInfo;

    // get the detailed data from the API
    $.get("/api/member", function(data) {
      console.log(data);
      detailInfo = data;
      memID = data.congressNum;
      console.log(memID);

      // should probably put everything in here
      // create the image
      var img = $('<img>');
      img.attr({
        src: detailInfo.photo,
        alt: "Picture of " + detailInfo.name,
        class: "primary-image"
      });

      $('#pic-row').append(img);

      // create the name
      var name = $('<h2/>');
      name.attr("class", "name");
      name.text(detailInfo.title + " " + detailInfo.name);

      $('#name-row').append(name);

      // contact Information
      var fb = $('<a/>');
      fb.attr({
        href: detailInfo.contact.facebook,
        target: "_blank",
        class: "btn"
      });
      fb.text("facebook");

      $('#contact').append(fb);

      var twit = $('<a/>');
      twit.attr({
        href: detailInfo.contact.twitter,
        target: "_blank",
        class: "btn"
      });
      twit.text("Twitter");

      $('#contact').append(twit);

      var web = $('<a/>');
      web.attr({
        href: detailInfo.contact.website,
        target: "_blank",
        class: "btn"
      });
      web.text("Website");

      $('#contact').append(web);

      var phone = $('<p/>');
      phone.text(detailInfo.contact.phone);

      $('#contact').append(phone);

      if (detailInfo.roles[0].leadership_role !== null) {
        var leader = $('<p/>');
        leader.text("Currently: " + detailInfo.roles[0].leadership_role);

        $('.basic-info').append(leader);
      };

      var birth = $('<p/>');
      birth.text("Born: " + detailInfo.dob);

      $('.basic-info').append(birth);

      var enterCon = $('<p/>');
      enterCon.text(detailInfo.title + " " + detailInfo.name + " was first sworn in to Congress on: " + detailInfo.roles[detailInfo.roles.length - 1].start_date);

      $('.basic-info').append(enterCon);

      var noTerm = $('<p/>');
      var termsNoRpt = [];
      for (var i = 0; i < detailInfo.roles.length; i++) {
        if (detailInfo.roles[i].title === "Representative" || detailInfo.roles[i].short_title === "Sen.") {
          termsNoRpt.push(detailInfo.roles[i]);
        };
      };
      noTerm.text(detailInfo.title + " " + detailInfo.name + " has served a total of " + termsNoRpt.length + " terms in Congress");

      $('.basic-info').append(noTerm);

      var noBills = $('<p/>');
      noBills.text(detailInfo.title + " " + detailInfo.name + " has sponsored " + detailInfo.roles[0].bills_sponsored + " bills and has co-sponsored " + detailInfo.roles[0].bills_cosponsored + " bills in the current term");

      $('.basic-info').append(noBills);
    });

    // get the clean data from the server
    $.get("/api/clean", function(data){
      // console.log(data);
      cleanData = data;
      console.log(cleanData);
      stats();

      // trigger the charts
      $('#pVoteBtn').on('click', function() {
        $('#memDo').empty();
        $('#partyDo').empty();
        $('#chamDo').empty();
        $('.chart').empty();

        $('#doID').text("How often does " + detailInfo.title + " " + detailInfo.name + " vote with their party?");
        pctPartyVote(memID);
        memDonut(memID, "party");
      });

      $('#mVoteBtn').on('click', function() {
        $('#memDo').empty();
        $('#partyDo').empty();
        $('#chamDo').empty();
        $('.chart').empty();

        $('#doID').text("How often does " + detailInfo.title + " " + detailInfo.name + " miss votes?");
        pctMissVote(memID);
        memDonut(memID, "miss");
      });
    });
  });
</script>
</body>

</html>
